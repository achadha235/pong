<html>
	<head>
		<script src="js/socket.io.js"> </script>
	</head>

	<body>
		<div id='status'> </div>
		<canvas id='myCanvas'> </canvas>
	</body>
</html>

<style>
	#myCanvas {
		width: 400px;
		height: 400px;
	}
</style>

<script>

	var data ;
	var socket = io.connect('http://localhost:3000');
	var canvas = document.getElementById('myCanvas');
	var ctx = canvas.getContext("2d");
	var myPlayer;

	socket.on('update', function (model){
		data = model;
		console.log('updating model...');
		updateTable();
		drawCanvas();
	})
	socket.on('setPlayerNumber', function (assignment){
		myPlayer = assignment.yourPlayerNumber
	})

	var leftPressed = false;
	var rightPressed = false;

	window.addEventListener('keydown', function (e) {
    	if (e.keyCode === 37 && !leftPressed && !rightPressed) {
    		leftPressed = true;
	        socket.emit('moveLeft', {});
	    }
	    else if (e.keyCode === 39  && !leftPressed && !rightPressed){
	    	rightPressed = true;
	    	socket.emit('moveRight', {});
	    }
	}, false);

	window.addEventListener('keyup', function (e) {
    	if (e.keyCode === 37) {
    		leftPressed = false;
	        socket.emit('stop', {});
	    }
	    else if (e.keyCode === 39){
	    	rightPressed = false;
	    	socket.emit('stop', {});
	    }
	}, false);

	function updateTable(){
		console.log(data);
		document.getElementById('status').innerHTML = JSON.stringify(data);
	}

	function drawCanvas(){
		ctx.fillRect(0, 0, 400, 400);
	}

</script>
